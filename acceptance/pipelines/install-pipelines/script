tmpdir="./subdir"
pipelines="$tmpdir/pipelines"
mkdir -p $tmpdir

title "install pipelines"
trace errcode $CLI install-pipelines -d $tmpdir
trace errcode $pipelines | head -n1

title "pipelines already installed"
trace errcode $CLI install-pipelines -d $tmpdir
rm -f $pipelines

title "pipelines file exists, should not overwrite"
touch $pipelines
trace errcode $CLI install-pipelines -d $tmpdir
rm -f $pipelines

title "databricks executable called with alias"
cp $CLI $tmpdir/notdatabricks
trace errcode $tmpdir/notdatabricks install-pipelines -d $tmpdir
trace errcode $pipelines | head -n1

# Cleanup
rm -f $tmpdir/notdatabricks $pipelines
rm -rf $tmpdir
